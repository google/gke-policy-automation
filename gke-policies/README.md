# GKE Policy Automation library

**Note**: Policies in this directory are kept for older tool versions.
New development should be done in [gke-policies-v2 folder](./../gke-policies-v2-v2/README.md)

## Available Policies

<!-- BEGIN POLICY-DOC -->
|Name|Group|Description|CIS Benchmark|
|-|-|-|-|
|[Control Plane redundancy](../gke-policies-v2/policy/control_plane_redundancy.rego)|Availability|GKE cluster should be regional for maximum availability of control plane during upgrades and zonal outages||
|[Multi-zone node pools](../gke-policies-v2/policy/node_pool_multi_zone.rego)|Availability|GKE node pools should be regional (multiple zones) for maximum nodes availability during zonal outages||
|[Use Node Auto-Repair](../gke-policies-v2/policy/node_pool_autorepair.rego)|Availability|GKE node pools should have Node Auto-Repair enabled to configure Kubernetes Engine|[CIS GKE](https://cloud.google.com/kubernetes-engine/docs/concepts/cis-benchmarks#accessing-gke-benchmark) 1.2: 5.5.2|
|[Cloud Monitoring and Logging](../gke-policies-v2/policy/monitoring_and_logging.rego)|Maintenance|GKE cluster should use Cloud Logging and Monitoring|[CIS GKE](https://cloud.google.com/kubernetes-engine/docs/concepts/cis-benchmarks#accessing-gke-benchmark) 1.2: 5.7.1|
|[Enable binary authorization in the cluster](../gke-policies-v2/policy/cluster_binary_authorization.rego)|Management|GKE cluster should enable for deploy-time security control that ensures only trusted container images are deployed to gain tighter control over your container environment.|[CIS GKE](https://cloud.google.com/kubernetes-engine/docs/concepts/cis-benchmarks#accessing-gke-benchmark) 1.2: 5.10.5|
|[GKE Autopilot mode](../gke-policies-v2/policy/autopilot_cluster.rego)|Management|GKE Autopilot mode is the recommended way to operate a GKE cluster||
|[GKE VPC-native cluster](../gke-policies-v2/policy/vpc_native_cluster.rego)|Management|GKE cluster nodepool should be VPC-native as per our best-practices||
|[Receive updates about new GKE versions](../gke-policies-v2/policy/cluster_receive_updates.rego)|Management|GKE cluster should be proactively receive updates about GKE upgrades and GKE versions||
|[Schedule maintenance windows and exclusions](../gke-policies-v2/policy/cluster_maintenance_window.rego)|Management|GKE cluster should schedule maintenance windows and exclusions to upgrade predictability and to align updates with off-peak business hours.||
|[Use Compute Engine persistent disk CSI driver](../gke-policies-v2/policy/cluster_gce_csi_driver.rego)|Management|Automatic deployment and management of the Compute Engine persistent disk CSI driver. The driver provides support for features like customer managed encryption keys or volume snapshots.||
|[Version skew between node pools and control plane](../gke-policies-v2/policy/node_pool_version_skew.rego)|Management|Difference between cluster control plane version and node pools version should be no more than 2 minor versions.||
|[GKE L4 ILB Subsetting](../gke-policies-v2/policy/ilb_subsetting.rego)|Scalability|GKE cluster should use GKE L4 ILB Subsetting if nodes > 250||
|[GKE Nodes Limit](../gke-policies-v2/scalability/limits_nodes.rego)|Scalability|GKE Nodes Limit||
|[GKE node local DNS cache](../gke-policies-v2/policy/node_local_dns_cache.rego)|Scalability|GKE cluster should use node local DNS cache||
|[Number of HPAs in a cluster](../gke-policies-v2/scalability/limits_hpas.rego)|Scalability|The optimal number of Horizontal Pod Autoscalers in a cluster||
|[Number of PODs in a cluster](../gke-policies-v2/scalability/limits_pods.rego)|Scalability|The total number of PODs running in a cluster||
|[Number of PODs per node](../gke-policies-v2/scalability/limits_pods_per_node.rego)|Scalability|The total number of PODs running on a single node||
|[Number of containers in a cluster](../gke-policies-v2/scalability/limits_containers.rego)|Scalability|The total number of containers running in a cluster||
|[Number of namespaces in a cluster](../gke-policies-v2/scalability/limit_namespaces.rego)|Scalability|The total number of namespaces in a cluster||
|[Number of nodes in a nodepool zone](../gke-policies-v2/scalability/limits_nodes_per_pool_zone.rego)|Scalability|The total number of nodes running in a single node pool zone||
|[Number of secrets with KMS encryption](../gke-policies-v2/scalability/limit_secrets_encryption.rego)|Scalability|The total number of secrets when KMS secret encryption is enabled||
|[Number of services in a cluster](../gke-policies-v2/scalability/limit_services.rego)|Scalability|The total number of services running in a cluster||
|[Number of services per namespace](../gke-policies-v2/scalability/limit_services_per_ns.rego)|Scalability|The total number of services running in single namespace||
|[Use node pool autoscaling](../gke-policies-v2/policy/node_pool_autoscaling.rego)|Scalability|GKE node pools should have autoscaling configured to proper resize nodes according to traffic||
|[Control Plane endpoint access](../gke-policies-v2/policy/control_plane_access.rego)|Security|Control Plane endpoint access should be limited to authorized networks only|[CIS GKE](https://cloud.google.com/kubernetes-engine/docs/concepts/cis-benchmarks#accessing-gke-benchmark) 1.2: 5.6.3|
|[Control Plane endpoint visibility](../gke-policies-v2/policy/control_plane_endpoint.rego)|Security|Control Plane endpoint should be locked from external access|[CIS GKE](https://cloud.google.com/kubernetes-engine/docs/concepts/cis-benchmarks#accessing-gke-benchmark) 1.2: 5.6.4|
|[Enrollment in Release Channels](../gke-policies-v2/policy/cluster_release_channels.rego)|Security|GKE cluster should be enrolled in release channels|[CIS GKE](https://cloud.google.com/kubernetes-engine/docs/concepts/cis-benchmarks#accessing-gke-benchmark) 1.2: 5.5.4|
|[Ensure that node pool locations within Node Auto-Provisioning are covering more than one zone (or not enforced at all)](../gke-policies-v2/policy/nap_forbid_single_zone.rego)|Security|Node Auto-Provisioning configuration should cover more than one zone|[CIS GKE](https://cloud.google.com/kubernetes-engine/docs/concepts/cis-benchmarks#accessing-gke-benchmark) 1.2: 5.2.1|
|[Ensure that nodes in Node Auto-Provisioning node pools will use Container-Optimized OS](../gke-policies-v2/policy/nap_use_cos.rego)|Security|Nodes in Node Auto-Provisioning should use Container-Optimized OS|[CIS GKE](https://cloud.google.com/kubernetes-engine/docs/concepts/cis-benchmarks#accessing-gke-benchmark) 1.2: 5.2.1|
|[Ensure that nodes in Node Auto-Provisioning node pools will use integrity monitoring](../gke-policies-v2/policy/nap_integrity_monitoring.rego)|Security|Nodes in Node Auto-Provisioning should use integrity monitoring|[CIS GKE](https://cloud.google.com/kubernetes-engine/docs/concepts/cis-benchmarks#accessing-gke-benchmark) 1.2: 5.2.1|
|[Forbid default Service Accounts in Node Auto-Provisioning](../gke-policies-v2/policy/nap_forbid_default_sa.rego)|Security|Node Auto-Provisioning configuration should not allow default Service Accounts|[CIS GKE](https://cloud.google.com/kubernetes-engine/docs/concepts/cis-benchmarks#accessing-gke-benchmark) 1.2: 5.2.1|
|[Forbid default compute SA on node_pool](../gke-policies-v2/policy/node_pool_forbid_default_sa.rego)|Security|GKE node pools should have a dedicated sa with a restricted set of permissions|[CIS GKE](https://cloud.google.com/kubernetes-engine/docs/concepts/cis-benchmarks#accessing-gke-benchmark) 1.2: 5.2.1|
|[GKE Network Policies engine](../gke-policies-v2/policy/network_policies.rego)|Security|GKE cluster should have Network Policies or Dataplane V2 enabled|[CIS GKE](https://cloud.google.com/kubernetes-engine/docs/concepts/cis-benchmarks#accessing-gke-benchmark) 1.2: 5.6.7|
|[GKE RBAC authorization](../gke-policies-v2/policy/control_plane_disable_legacy_authorization.rego)|Security|GKE cluster should use RBAC instead of legacy ABAC authorization|[CIS GKE](https://cloud.google.com/kubernetes-engine/docs/concepts/cis-benchmarks#accessing-gke-benchmark) 1.2: 5.8.4|
|[GKE Shielded Nodes](../gke-policies-v2/policy/shielded_nodes.rego)|Security|GKE cluster should use shielded nodes|[CIS GKE](https://cloud.google.com/kubernetes-engine/docs/concepts/cis-benchmarks#accessing-gke-benchmark) 1.2: 5.5.5|
|[GKE Workload Identity](../gke-policies-v2/policy/workload_identity.rego)|Security|GKE cluster should have Workload Identity enabled|[CIS GKE](https://cloud.google.com/kubernetes-engine/docs/concepts/cis-benchmarks#accessing-gke-benchmark) 1.2: 5.2.2|
|[GKE private cluster](../gke-policies-v2/policy/private_cluster.rego)|Security|GKE cluster should be private to ensure network isolation|[CIS GKE](https://cloud.google.com/kubernetes-engine/docs/concepts/cis-benchmarks#accessing-gke-benchmark) 1.2: 5.6.5|
|[Integrity monitoring on the nodes](../gke-policies-v2/policy/node_pool_integrity_monitoring.rego)|Security|GKE node pools should have integrity monitoring feature enabled to detect changes in a VM boot measurements|[CIS GKE](https://cloud.google.com/kubernetes-engine/docs/concepts/cis-benchmarks#accessing-gke-benchmark) 1.2: 5.5.6|
|[Kubernetes secrets encryption](../gke-policies-v2/policy/secret_encryption.rego)|Security|GKE cluster should use encryption for kubernetes application secrets|[CIS GKE](https://cloud.google.com/kubernetes-engine/docs/concepts/cis-benchmarks#accessing-gke-benchmark) 1.2: 5.3.1|
|[Secure boot on the nodes](../gke-policies-v2/policy/node_pool_secure_boot.rego)|Security|Secure Boot helps ensure that the system only runs authentic software by verifying the digital signature of all boot components, and halting the boot process if signature verification fails|[CIS GKE](https://cloud.google.com/kubernetes-engine/docs/concepts/cis-benchmarks#accessing-gke-benchmark) 1.2: 5.5.7|
|[Use Container-Optimized OS](../gke-policies-v2/policy/node_pool_use_cos.rego)|Security|GKE node pools should use Container-Optimized OS which is maintained by Google and optimized for running Docker containers with security and efficiency.|[CIS GKE](https://cloud.google.com/kubernetes-engine/docs/concepts/cis-benchmarks#accessing-gke-benchmark) 1.2: 5.5.1|
|[Use Node Auto-Upgrade](../gke-policies-v2/policy/node_pool_autoupgrade.rego)|Security|GKE node pools should have Node Auto-Upgrade enabled to configure Kubernetes Engine|[CIS GKE](https://cloud.google.com/kubernetes-engine/docs/concepts/cis-benchmarks#accessing-gke-benchmark) 1.2: 5.5.3|
|[Use RBAC Google group](../gke-policies-v2/policy/node_rbac_security_group.rego)|Security|GKE cluster should have RBAC security Google group enabled|[CIS GKE](https://cloud.google.com/kubernetes-engine/docs/concepts/cis-benchmarks#accessing-gke-benchmark) 1.2: 5.8.3|
