# GKE Policy Automation library

## Policy structure

Please refer to the [Policy Authoring Guide](./AUTHORING.md) for details about structure
of our policy files.

## Available Policies

<!-- BEGIN POLICY-DOC -->
|Name|Group|Description|CIS Benchmark|
|-|-|-|-|
|[Enable node auto-repair](../gke-policies-v2/policy/node_pool_autorepair.rego)|Availability|GKE node pools should have Node Auto-Repair enabled to configure Kubernetes Engine|[CIS GKE](https://cloud.google.com/kubernetes-engine/docs/concepts/cis-benchmarks#accessing-gke-benchmark) 1.4: 5.5.2|
|[Ensure redudndancy of the node pools](../gke-policies-v2/policy/node_pool_multi_zone.rego)|Availability|GKE node pools should be regional (multiple zones) for maximum nodes availability during zonal outages||
|[Ensure redundancy of the Control Plane](../gke-policies-v2/policy/control_plane_redundancy.rego)|Availability|GKE cluster should be regional for maximum availability of control plane during upgrades and zonal outages||
|[Enable Cloud Monitoring and Logging](../gke-policies-v2/policy/monitoring_and_logging.rego)|Maintenance|GKE cluster should use Cloud Logging and Monitoring|[CIS GKE](https://cloud.google.com/kubernetes-engine/docs/concepts/cis-benchmarks#accessing-gke-benchmark) 1.4: 5.7.1|
|[Enable Compute Engine persistent disk CSI driver](../gke-policies-v2/policy/cluster_gce_csi_driver.rego)|Management|Automatic deployment and management of the Compute Engine persistent disk CSI driver. The driver provides support for features like customer managed encryption keys or volume snapshots.||
|[Enable GKE upgrade notifications](../gke-policies-v2/policy/cluster_receive_updates.rego)|Management|GKE cluster should be proactively receive updates about GKE upgrades and GKE versions||
|[Enable binary authorization in the cluster](../gke-policies-v2/policy/cluster_binary_authorization.rego)|Management|GKE cluster should enable for deploy-time security control that ensures only trusted container images are deployed to gain tighter control over your container environment.|[CIS GKE](https://cloud.google.com/kubernetes-engine/docs/concepts/cis-benchmarks#accessing-gke-benchmark) 1.4: 5.10.5|
|[Enable maintenance windows](../gke-policies-v2/policy/cluster_maintenance_window.rego)|Management|GKE cluster should use maintenance windows and exclusions to upgrade predictability and to align updates with off-peak business hours.||
|[Ensure acceptable version skew in a cluster](../gke-policies-v2/policy/node_pool_version_skew.rego)|Management|Difference between cluster control plane version and node pools version should be no more than 2 minor versions.||
|[Use GKE Autopilot mode](../gke-policies-v2/policy/autopilot_cluster.rego)|Management|GKE Autopilot mode is the recommended way to operate a GKE cluster||
|[Use VPC-native cluster](../gke-policies-v2/policy/vpc_native_cluster.rego)|Management|GKE cluster nodepool should be VPC-native as per our best-practices|[CIS GKE](https://cloud.google.com/kubernetes-engine/docs/concepts/cis-benchmarks#accessing-gke-benchmark) 1.4: 5.6.2|
|[Enable GKE L4 ILB Subsetting](../gke-policies-v2/policy/ilb_subsetting.rego)|Scalability|GKE cluster should use GKE L4 ILB Subsetting if nodes > 250||
|[Enable GKE node local DNS cache](../gke-policies-v2/policy/node_local_dns_cache.rego)|Scalability|GKE cluster should use node local DNS cache||
|[Enable node pool auto-scaling](../gke-policies-v2/policy/node_pool_autoscaling.rego)|Scalability|GKE node pools should have autoscaling configured to proper resize nodes according to traffic||
|[GKE Nodes Limit](../gke-policies-v2/scalability/limits_nodes.rego)|Scalability|GKE Nodes Limit||
|[Number of HPAs in a cluster](../gke-policies-v2/scalability/limits_hpas.rego)|Scalability|The optimal number of Horizontal Pod Autoscalers in a cluster||
|[Number of PODs in a cluster](../gke-policies-v2/scalability/limits_pods.rego)|Scalability|The total number of PODs running in a cluster||
|[Number of PODs per node](../gke-policies-v2/scalability/limits_pods_per_node.rego)|Scalability|The total number of PODs running on a single node||
|[Number of containers in a cluster](../gke-policies-v2/scalability/limits_containers.rego)|Scalability|The total number of containers running in a cluster||
|[Number of namespaces in a cluster](../gke-policies-v2/scalability/limit_namespaces.rego)|Scalability|The total number of namespaces in a cluster||
|[Number of nodes in a nodepool zone](../gke-policies-v2/scalability/limits_nodes_per_pool_zone.rego)|Scalability|The total number of nodes running in a single node pool zone||
|[Number of secrets with KMS encryption](../gke-policies-v2/scalability/limit_secrets_encryption.rego)|Scalability|The total number of secrets when KMS secret encryption is enabled||
|[Number of services in a cluster](../gke-policies-v2/scalability/limit_services.rego)|Scalability|The total number of services running in a cluster||
|[Number of services per namespace](../gke-policies-v2/scalability/limit_services_per_ns.rego)|Scalability|The total number of services running in single namespace||
|[Change default Service Accounts in Node Auto-Provisioning](../gke-policies-v2/policy/nap_forbid_default_sa.rego)|Security|Node Auto-Provisioning configuration should not allow default Service Accounts|[CIS GKE](https://cloud.google.com/kubernetes-engine/docs/concepts/cis-benchmarks#accessing-gke-benchmark) 1.4: 5.2.1|
|[Change default Service Accounts in node pools](../gke-policies-v2/policy/node_pool_forbid_default_sa.rego)|Security|GKE node pools should have a dedicated sa with a restricted set of permissions|[CIS GKE](https://cloud.google.com/kubernetes-engine/docs/concepts/cis-benchmarks#accessing-gke-benchmark) 1.4: 5.2.1|
|[Configure Container-Optimized OS for Node Auto-Provisioning node pools](../gke-policies-v2/policy/nap_use_cos.rego)|Security|Nodes in Node Auto-Provisioning should use Container-Optimized OS|[CIS GKE](https://cloud.google.com/kubernetes-engine/docs/concepts/cis-benchmarks#accessing-gke-benchmark) 1.4: 5.5.1|
|[Configure Container-Optimized OS for node pools](../gke-policies-v2/policy/node_pool_use_cos.rego)|Security|GKE node pools should use Container-Optimized OS which is maintained by Google and optimized for running Docker containers with security and efficiency.|[CIS GKE](https://cloud.google.com/kubernetes-engine/docs/concepts/cis-benchmarks#accessing-gke-benchmark) 1.4: 5.5.1|
|[Disable control plane certificate authentication](../gke-policies-v2/policy/control_plane_disable_cert_authentication.rego)|Security|Disable Client Certificates, which require certificate rotation, for authentication. Instead, use another authentication method like OpenID Connect.|[CIS GKE](https://cloud.google.com/kubernetes-engine/docs/concepts/cis-benchmarks#accessing-gke-benchmark) 1.4: 5.8.2|
|[Disable legacy ABAC authorization](../gke-policies-v2/policy/control_plane_disable_legacy_authorization.rego)|Security|GKE cluster should use RBAC instead of legacy ABAC authorization|[CIS GKE](https://cloud.google.com/kubernetes-engine/docs/concepts/cis-benchmarks#accessing-gke-benchmark) 1.4: 5.8.4|
|[Disalbe control plane basic authentication](../gke-policies-v2/policy/control_plane_disable_password_authentication.rego)|Security|Disable Basic Authentication (basic auth) for API server authentication as it uses static passwords which need to be rotated.|[CIS GKE](https://cloud.google.com/kubernetes-engine/docs/concepts/cis-benchmarks#accessing-gke-benchmark) 1.4: 5.8.1|
|[Enable Customer-Managed Encryption Keys for persistent disks](../gke-policies-v2/policy/node_pool_disk_encryption.rego)|Security|Use Customer-Managed Encryption Keys (CMEK) to encrypt node boot and dynamically-provisioned attached Google Compute Engine Persistent Disks (PDs) using keys managed within Cloud Key Management Service (Cloud KMS).|[CIS GKE](https://cloud.google.com/kubernetes-engine/docs/concepts/cis-benchmarks#accessing-gke-benchmark) 1.4: 5.9.1|
|[Enable GKE intranode visibility](../gke-policies-v2/policy/intranode_visibility.rego)|Security|GKE cluster should have intranode visibility enabled|[CIS GKE](https://cloud.google.com/kubernetes-engine/docs/concepts/cis-benchmarks#accessing-gke-benchmark) 1.4: 5.6.1|
|[Enable Google Groups for RBAC](../gke-policies-v2/policy/node_rbac_security_group.rego)|Security|GKE cluster should have RBAC security Google group enabled|[CIS GKE](https://cloud.google.com/kubernetes-engine/docs/concepts/cis-benchmarks#accessing-gke-benchmark) 1.4: 5.8.3|
|[Enable Kubernetes Network Policies](../gke-policies-v2/policy/network_policies.rego)|Security|GKE cluster should have Network Policies or Dataplane V2 enabled|[CIS GKE](https://cloud.google.com/kubernetes-engine/docs/concepts/cis-benchmarks#accessing-gke-benchmark) 1.4: 5.6.7|
|[Enable Kubernetes secrets encryption](../gke-policies-v2/policy/secret_encryption.rego)|Security|GKE cluster should use encryption for kubernetes application secrets|[CIS GKE](https://cloud.google.com/kubernetes-engine/docs/concepts/cis-benchmarks#accessing-gke-benchmark) 1.4: 5.3.1|
|[Enable Secure boot for node pools](../gke-policies-v2/policy/node_pool_secure_boot.rego)|Security|Secure Boot helps ensure that the system only runs authentic software by verifying the digital signature of all boot components, and halting the boot process if signature verification fails|[CIS GKE](https://cloud.google.com/kubernetes-engine/docs/concepts/cis-benchmarks#accessing-gke-benchmark) 1.4: 5.5.7|
|[Enable Security Posture dashboard](../gke-policies-v2/policy/cluster_enable_security_posture.rego)|Security|The Security Posture feature enables scanning of clusters and running workloads against standards and industry best practices. The dashboard displays the scan results and provides actionable recommendations for concerns. ||
|[Enable Shielded Nodes](../gke-policies-v2/policy/shielded_nodes.rego)|Security|GKE cluster should use shielded nodes|[CIS GKE](https://cloud.google.com/kubernetes-engine/docs/concepts/cis-benchmarks#accessing-gke-benchmark) 1.4: 5.5.5|
|[Enable Workload vulnerability scanning](../gke-policies-v2/policy/cluster_enable_workload_scanning.rego)|Security|The Workload vulnerability scanning is a set of capabilities in the security posture dashboard that automatically  scans for known vulnerabilities in your container images and in specific language packages during the runtime phase of software delivery lifecycle.||
|[Enable control plane private endpoint](../gke-policies-v2/policy/control_plane_endpoint.rego)|Security|Control Plane endpoint should be locked from external access|[CIS GKE](https://cloud.google.com/kubernetes-engine/docs/concepts/cis-benchmarks#accessing-gke-benchmark) 1.4: 5.6.4|
|[Enable integrity monitoring for Node Auto-Provisioning node pools](../gke-policies-v2/policy/nap_integrity_monitoring.rego)|Security|Nodes in Node Auto-Provisioning should use integrity monitoring|[CIS GKE](https://cloud.google.com/kubernetes-engine/docs/concepts/cis-benchmarks#accessing-gke-benchmark) 1.4: 5.5.6|
|[Enable integrity monitoring for node pools](../gke-policies-v2/policy/node_pool_integrity_monitoring.rego)|Security|GKE node pools should have integrity monitoring feature enabled to detect changes in a VM boot measurements|[CIS GKE](https://cloud.google.com/kubernetes-engine/docs/concepts/cis-benchmarks#accessing-gke-benchmark) 1.4: 5.5.6|
|[Enable node auto-upgrade](../gke-policies-v2/policy/node_pool_autoupgrade.rego)|Security|GKE node pools should have Node Auto-Upgrade enabled to configure Kubernetes Engine|[CIS GKE](https://cloud.google.com/kubernetes-engine/docs/concepts/cis-benchmarks#accessing-gke-benchmark) 1.4: 5.5.3|
|[Enroll cluster in Release Channels](../gke-policies-v2/policy/cluster_release_channels.rego)|Security|GKE cluster should be enrolled in release channels|[CIS GKE](https://cloud.google.com/kubernetes-engine/docs/concepts/cis-benchmarks#accessing-gke-benchmark) 1.4: 5.5.4|
|[Ensure redundancy of Node Auto-provisioning node pools](../gke-policies-v2/policy/nap_forbid_single_zone.rego)|Security|Node Auto-Provisioning configuration should cover more than one zone||
|[Limit Control Plane endpoint access](../gke-policies-v2/policy/control_plane_access.rego)|Security|Control Plane endpoint access should be limited to authorized networks only|[CIS GKE](https://cloud.google.com/kubernetes-engine/docs/concepts/cis-benchmarks#accessing-gke-benchmark) 1.4: 5.6.3|
|[Use GKE Workload Identity](../gke-policies-v2/policy/workload_identity.rego)|Security|GKE cluster should have Workload Identity enabled|[CIS GKE](https://cloud.google.com/kubernetes-engine/docs/concepts/cis-benchmarks#accessing-gke-benchmark) 1.4: 5.2.2|
|[Use private nodes](../gke-policies-v2/policy/private_cluster.rego)|Security|GKE cluster should be private to ensure network isolation|[CIS GKE](https://cloud.google.com/kubernetes-engine/docs/concepts/cis-benchmarks#accessing-gke-benchmark) 1.4: 5.6.5|
